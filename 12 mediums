SAST
12
0 12 0 0
apex
FLS_Create
Description: The application attempts to access an object in @DestinationElement in @DestinationFile at line
@DestinationLine without checking if a user is authorized to do so. This object is then inserted into the
database, using the data provided at @SourceElement in @SourceFile at line @SourceLine.
Query Path: Apex/Apex_Force_com_Serious_Security_Risk/FLS_Create
Total Flows: 2
NEW
State: To Verify
Status: NEW
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 22:21:31 +0000 UTC
Source element: getrecordtypeid
Source file: /classes/SecAPIReleaseScanController.cls
Source method: getbuildid
Source line: 97
Destination element: lstscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: getbuildid
Destination line: 99
Compliances: ASA Premium, CWE top 25, PCI DSS v3.2.1, Top Tier, OWASP Top 10 2021, PCI DSS v4.0,
SANS top 25, MOIS(KISA) Secure Coding 2021, OWASP ASVS
CWE: CWE-285
14/21
NEW
State: To Verify
Status: NEW
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 22:21:31 +0000 UTC
Source element: releaseid
Source file: /classes/SecAPIReleaseScanController.cls
Source method: getbuildid
Source line: 97
Destination element: lstscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: getbuildid
Destination line: 99
Compliances: ASA Premium, CWE top 25, PCI DSS v3.2.1, Top Tier, OWASP Top 10 2021, PCI DSS v4.0,
SANS top 25, MOIS(KISA) Secure Coding 2021, OWASP ASVS
CWE: CWE-285
15/21
FLS_Update
Description: The application attempts to access an object in @DestinationElement in @DestinationFile at line
@DestinationLine without checking if a user is authorized to do so. The object is updated with the data
provided at @SourceElement in @SourceFile at line @SourceLine.
Query Path: Apex/Apex_Force_com_Serious_Security_Risk/FLS_Update
Total Flows: 10
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: sca_scan_id__c
Source file: /classes/SecAPIReleaseScanController.cls
Source method: scascan
Source line: 507
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: scascan
Destination line: 523
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
16/21
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: sca_error_message__c
Source file: /classes/SecAPIReleaseScanController.cls
Source method: scascan
Source line: 514
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: scascan
Destination line: 523
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: recordtypeid
Source file: /classes/SecAPIReleaseScanController.cls
Source method: secapiscan
Source line: 340
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: secapiscan
Destination line: 359
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
17/21
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: sca_status_url__c
Source file: /classes/SecAPIReleaseScanController.cls
Source method: scascan
Source line: 504
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: scascan
Destination line: 523
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: secapi_scan_id__c
Source file: /classes/SecAPIReleaseScanController.cls
Source method: secapiscan
Source line: 341
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: secapiscan
Destination line: 359
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
18/21
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: id
Source file: /classes/SecAPIReleaseScanController.cls
Source method: scascan
Source line: 503
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: scascan
Destination line: 523
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: status_url__c
Source file: /classes/SecAPIReleaseScanController.cls
Source method: secapiscan
Source line: 337
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: secapiscan
Destination line: 359
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
19/21
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: id
Source file: /classes/SecAPIReleaseScanController.cls
Source method: secapiscan
Source line: 336
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: secapiscan
Destination line: 359
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: release_copado__c
Source file: /classes/SecAPIReleaseScanController.cls
Source method: secapiscan
Source line: 338
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: secapiscan
Destination line: 359
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
20/21
RECURRENT
State: To Verify
Status: RECURRENT
Group name: Apex_Force_com_Serious_Security_Risk
First scan id: fb865857-cb5c-4a19-a3d4-cc7ff38fc411
Found date: 2024-12-19 22:21:32 +0000 UTC
First found date: 2024-12-19 13:28:08 +0000 UTC
Source element: error_message__c
Source file: /classes/SecAPIReleaseScanController.cls
Source method: secapiscan
Source line: 349
Destination element: lstsecscanresults
Destination file: /classes/SecAPIReleaseScanController.cls
Destination method: secapiscan
Destination line: 359
Compliances: MOIS(KISA) Secure Coding 2021, PCI DSS v3.2.1, PCI DSS v4.0, ASA Premium, CWE top 25,
OWASP ASVS, SANS top 25, OWASP Top 10 2021, Top Tier
CWE: CWE-285
---------------------------------------------------------

method--getbuildid, got medium at these source element--getrecordtypeid, released and destination elemt was--lstscanresults. this was the particular line from code
lstScanResults.add(new SEC_API_Scan_Result__c(Release_Copado__c = releaseId,RecordTypeId=Schema.SObjectType.SEC_API_Scan_Result__c.getRecordTypeInfosByName().get('Release').getRecordTypeId(),Repo_Branch__c=BranchName));
            if(!lstScanResults.isEmpty() && Schema.sObjectType.SEC_API_Scan_Result__c.isCreateable()){
                Insert lstScanResults;
            }

method--scascan,  got medium at these source element--sca_scan_id__c,sca_error_message__c, sca_status_url__c,id, and destination elementt was--lstsecscanresults
this was the particular line from code

system.debug('@@@ appReqIdforSCA'+appReqIdSCA);
                sr.Id = recordId;
                sr.SCA_Status_URL__c = appReqIdSCA;
                sr.SCA_scan_Status__c = 'Callout 1 Completed';
                //sr.SecAPI_Scan_Id__c = appReqIdSCA.split('/')[1];
                sr.SCA_Scan_Id__c = appReqIdSCA.split('/')[1];
                //sr.SCA_Scan_Id__c = appReqIdSCA.split('/')[1];
                resp = appReqIdSCA;
            }
            else{
                sr.Id = recordId;
                sr.SCA_scan_Status__c = 'Callout 1 Failed';
                sr.SCA_Error_Message__c = 'Status Code '+SCAres.getStatusCode() +', Error Message '+SCAres.getBody();
                toUpdateRelease.add(new copado__Release__c(Id=releaseId,SCA_Scan_Status__c='Completed',SecApiScanProjectCounter__c = scanCounter));  
                resp = 'Error occured during 1st Callout. Response Status Code : ' +SCAres.getStatusCode()+ ', Response Status : ' + SCAres.getStatus()+', Response Message : ' + SCAres.getBody();
            }


method--secAPIScan,  got medium at these source element-recordtypeid, secapi_scan_id__c, status_url__c, id, release_copado__c, error_message__c and destination elementt was--lstsecscanresults
this was the particular line from code

system.debug('@@@ appReqId'+appReqId);
                sr.Id = recordId;
                sr.status_URL__c = appReqId;
                sr.Release_Copado__c = releaseId;
                sr.Scan_Status__c = 'Callout 1 Completed';
                sr.RecordTypeId = Schema.SObjectType.SEC_API_Scan_Result__c.getRecordTypeInfosByName().get('Release').getRecordTypeId();
                sr.SecAPI_Scan_Id__c = appReqId.split('/')[1];
                resp = appReqId;
            }
            else{
                sr.Id = recordId;
                sr.Release_Copado__c = releaseId;
                sr.Scan_Status__c = 'Callout 1 Failed';
                sr.RecordTypeId = Schema.SObjectType.SEC_API_Scan_Result__c.getRecordTypeInfosByName().get('Release').getRecordTypeId();
                sr.Error_Message__c = 'Status Code '+res.getStatusCode() +', Error Message '+res.getBody();
                //change made by kamal in updating SEC_API_Scan_Status__c='completed ' to in progress
                toUpdateRelease.add(new copado__Release__c(Id=releaseId,SEC_API_Scan_Status__c='In-Progress',Current_Glapi_Status__c = 'Security Scan Failed', SecApiScanProjectCounter__c = scanCounter));  //Needs to verify1
                resp = 'Error occured during 1st Callout. Response Status Code : ' +res.getStatusCode()+ ', Response Status : ' + res.getStatus()+', Response Message : ' + res.getBody();
            }

---------------------------------
lstScanResults.add(new SEC_API_Scan_Result__c(
    Release_Copado__c = releaseId,
    RecordTypeId = Schema.SObjectType.SEC_API_Scan_Result__c.getRecordTypeInfosByName().get('Release').getRecordTypeId(),
    Repo_Branch__c = BranchName
));

// Validate field and object permissions before inserting
if (!Schema.sObjectType.SEC_API_Scan_Result__c.isCreateable() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.Release_Copado__c.isCreateable() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.RecordTypeId.isCreateable() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.Repo_Branch__c.isCreateable()) {
    throw new AuraHandledException('User does not have appropriate access to create SEC_API_Scan_Result__c fields.');
}

if (!lstScanResults.isEmpty()) {
    insert lstScanResults;
}
-------------------------
system.debug('@@@ appReqIdforSCA' + appReqIdSCA);
if (!Schema.sObjectType.SEC_API_Scan_Result__c.fields.Id.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.SCA_Status_URL__c.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.SCA_scan_Status__c.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.SCA_Scan_Id__c.isAccessible()) {
    throw new AuraHandledException('User does not have appropriate access to SEC_API_Scan_Result__c fields.');
}

sr.Id = recordId;
sr.SCA_Status_URL__c = appReqIdSCA;
sr.SCA_scan_Status__c = 'Callout 1 Completed';
sr.SCA_Scan_Id__c = appReqIdSCA.split('/')[1];
resp = appReqIdSCA;

if (!Schema.sObjectType.SEC_API_Scan_Result__c.fields.SCA_Error_Message__c.isAccessible()) {
    throw new AuraHandledException('User does not have appropriate access to SCA_Error_Message__c field.');
}

else {
    sr.Id = recordId;
    sr.SCA_scan_Status__c = 'Callout 1 Failed';
    sr.SCA_Error_Message__c = 'Status Code ' + SCAres.getStatusCode() + ', Error Message ' + SCAres.getBody();

    if (!Schema.sObjectType.copado__Release__c.fields.SCA_Scan_Status__c.isUpdateable() ||
        !Schema.sObjectType.copado__Release__c.fields.SecApiScanProjectCounter__c.isUpdateable()) {
        throw new AuraHandledException('User does not have appropriate access to update copado__Release__c fields.');
    }

    toUpdateRelease.add(new copado__Release__c(
        Id = releaseId,
        SCA_Scan_Status__c = 'Completed',
        SecApiScanProjectCounter__c = scanCounter
    ));
    resp = 'Error occurred during 1st Callout. Response Status Code : ' + SCAres.getStatusCode() +
           ', Response Status : ' + SCAres.getStatus() + ', Response Message : ' + SCAres.getBody();
}
--------------------------------

system.debug('@@@ appReqId' + appReqId);

if (!Schema.sObjectType.SEC_API_Scan_Result__c.fields.Id.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.status_URL__c.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.Release_Copado__c.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.Scan_Status__c.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.RecordTypeId.isAccessible() ||
    !Schema.sObjectType.SEC_API_Scan_Result__c.fields.SecAPI_Scan_Id__c.isAccessible()) {
    throw new AuraHandledException('User does not have appropriate access to SEC_API_Scan_Result__c fields.');
}

sr.Id = recordId;
sr.status_URL__c = appReqId;
sr.Release_Copado__c = releaseId;
sr.Scan_Status__c = 'Callout 1 Completed';
sr.RecordTypeId = Schema.SObjectType.SEC_API_Scan_Result__c.getRecordTypeInfosByName().get('Release').getRecordTypeId();
sr.SecAPI_Scan_Id__c = appReqId.split('/')[1];
resp = appReqId;

if (!Schema.sObjectType.SEC_API_Scan_Result__c.fields.Error_Message__c.isAccessible()) {
    throw new AuraHandledException('User does not have appropriate access to Error_Message__c field.');
}

else {
    sr.Id = recordId;
    sr.Release_Copado__c = releaseId;
    sr.Scan_Status__c = 'Callout 1 Failed';
    sr.RecordTypeId = Schema.SObjectType.SEC_API_Scan_Result__c.getRecordTypeInfosByName().get('Release').getRecordTypeId();
    sr.Error_Message__c = 'Status Code ' + res.getStatusCode() + ', Error Message ' + res.getBody();

    if (!Schema.sObjectType.copado__Release__c.fields.SEC_API_Scan_Status__c.isUpdateable() ||
        !Schema.sObjectType.copado__Release__c.fields.SecApiScanProjectCounter__c.isUpdateable()) {
        throw new AuraHandledException('User does not have appropriate access to update copado__Release__c fields.');
    }

    toUpdateRelease.add(new copado__Release__c(
        Id = releaseId,
        SEC_API_Scan_Status__c = 'In-Progress',
        Current_Glapi_Status__c = 'Security Scan Failed',
        SecApiScanProjectCounter__c = scanCounter
    ));
    resp = 'Error occurred during 1st Callout. Response Status Code : ' + res.getStatusCode() +
           ', Response Status : ' + res.getStatus() + ', Response Message : ' + res.getBody();
}


